<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Social Media Card Generator - Quantum Investor Digest</title>
  <meta name="description" content="Generate shareable Twitter and LinkedIn cards for AI-managed portfolio updates." />
  <meta name="author" content="Michael Gavrilov">
  <meta name="theme-color" content="#000000">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'nonce-qi123' https://cdn.jsdelivr.net; style-src 'self' 'nonce-qi123'; img-src 'self' data:; font-src 'self' data:; connect-src 'self' https://cdn.jsdelivr.net; frame-src 'none'; base-uri 'self'; form-action 'self';">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta name="robots" content="noindex, nofollow">
  <link rel="canonical" href="https://quantuminvestor.net/Posts/social-card-generator.html" />
  <link rel="icon" href="../Media/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="../styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js" nonce="qi123"></script>
  <script src="../js/template-loader.js" defer nonce="qi123"></script>
  <script src="../js/mobile-menu.js" defer nonce="qi123"></script>
  <style nonce="qi123">
    body { font-family: system-ui, sans-serif; }
    
    .pixabay-hero {
      position: relative;
      padding: 2.75rem 2.5rem;
      border-radius: 1.25rem;
      border: 1px solid rgba(168, 85, 247, 0.4);
      background: radial-gradient(circle at 0% 0%, rgba(168, 85, 247, 0.15), transparent 55%),
                  radial-gradient(circle at 100% 100%, rgba(59, 130, 246, 0.12), transparent 55%),
                  linear-gradient(135deg, rgba(10, 10, 10, 0.95), rgba(15, 23, 42, 0.95));
      overflow: hidden;
    }
    
    .pixabay-hero::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 20% -10%, rgba(148, 163, 184, 0.15), transparent 40%);
      pointer-events: none;
    }
    
    .pixabay-hero::after {
      content: '';
      position: absolute;
      bottom: -140px;
      right: -120px;
      width: 320px;
      height: 320px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(168, 85, 247, 0.35), transparent 60%);
    }
    
    .pixabay-pill {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.35rem 0.85rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background-color: rgba(17, 24, 39, 0.6);
      color: var(--text-gray-400);
      font-size: 0.75rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
    }
    
    .pixabay-pill::before {
      content: '';
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #ffffff, var(--primary));
    }
    
    .pixabay-title {
      font-size: clamp(2.4rem, 4vw, 3.25rem);
      letter-spacing: -0.015em;
    }
    
    .pixabay-hero-copy {
      max-width: 100%;
    }
    
    .control-panel { background:var(--bg-gray-900); border:1px solid var(--border-gray-800); padding:1.5rem; border-radius:.75rem; margin-bottom:2rem; box-shadow:0 12px 28px rgba(2,6,23,.55); }
    .control-row { display:flex; gap:1rem; align-items:center; margin-bottom:1rem; flex-wrap:wrap; }
    .control-row label { font-size:0.95rem; font-weight:600; color:var(--text-white); min-width:120px; }
    .control-row select { background:#161616; border:1px solid #333; padding:.6rem 1rem; border-radius:.5rem; color:#fff; font-size:.9rem; }
    
    .platform-tabs { display:flex; gap:.75rem; margin-bottom:1.5rem; }
    .platform-tabs[role="tablist"] { border-bottom:1px solid var(--border-gray-800); padding-bottom:.5rem; }
    .platform-tab { background:var(--bg-gray-800); border:1px solid var(--border-gray-800); padding:.6rem 1.25rem; border-radius:.5rem; cursor:pointer; transition:all .2s; font-size:.85rem; letter-spacing:.05em; display:flex; align-items:center; }
    .platform-tab[aria-selected="true"] { background:var(--primary); border-color:#9575ff; color:#fff; }
    .platform-tab:focus { outline:2px solid var(--primary); outline-offset:2px; }
    
    .cards-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(400px, 1fr)); gap:1.5rem; margin-bottom:2rem; }
    .card-wrapper { background:#0f0f0f; border:1px solid #252525; border-radius:.75rem; padding:1.25rem; }
    .card-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem; }
    .card-title { font-size:.85rem; font-weight:600; color:#aaa; text-transform:uppercase; letter-spacing:.05em; }
    .card-actions { display:flex; gap:.5rem; }
    /* Shared action button styles (abstracted from previous inline styles) */
    .action-btn {
      background:var(--btn-bg, #1a1a1a);
      border:1px solid var(--btn-border, #333);
      padding:.5rem .85rem;
      border-radius:.5rem;
      font-size:.72rem;
      font-weight:600;
      letter-spacing:.04em;
      color:var(--btn-fg, #e5e5e5);
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:.35rem;
      text-decoration:none;
      user-select:none;
    }
    .action-btn--primary {
      background:var(--btn-primary-bg, #7e5bef);
      border:none;
      padding:.6rem 1.1rem;
      border-radius:.5rem;
      font-weight:600;
      font-size:.9rem;
      color:var(--btn-primary-fg, #fff);
      letter-spacing:.03em;
      cursor:pointer;
      min-height:2.5rem;
    }
    .action-btn:focus-visible, .action-btn--primary:focus-visible {
      outline:2px solid var(--primary);
      outline-offset:2px;
    }
    .action-btn:disabled, .action-btn[aria-disabled="true"],
    .action-btn--primary:disabled, .action-btn--primary[aria-disabled="true"] {
      opacity:.45;
      cursor:not-allowed;
    }
    .visually-hidden { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0 0 0 0); white-space:nowrap; border:0; }
    
    /* Card Canvas Containers */
    .card-canvas-wrapper { position:relative; border-radius:.5rem; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,.3); }
    
    /* Twitter Card (1200x675) */
    .twitter-card { 
      width:600px; 
      height:337.5px; 
      position:relative; 
      background:linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      padding:2rem;
      color:#fff;
      font-family:system-ui, -apple-system, sans-serif;
    }
    
    /* LinkedIn Card (1200x627) */
    .linkedin-card {
      width:600px;
      height:313.5px;
      position:relative;
      background:linear-gradient(135deg, #0e0e0e 0%, #1e1e1e 100%);
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      padding:2rem;
      color:#fff;
      font-family:system-ui, -apple-system, sans-serif;
    }
    
    .card-header-text { z-index:2; }
    .card-week { font-size:1.1rem; color:#999; font-weight:500; letter-spacing:.05em; }
    .card-headline { font-size:2rem; font-weight:800; line-height:1.2; margin-top:.5rem; }
    .card-metrics { display:flex; gap:2rem; margin-top:1rem; flex-wrap:wrap; }
    .card-metric { display:flex; flex-direction:column; }
    .card-metric-label { font-size:.7rem; color:#888; text-transform:uppercase; letter-spacing:.08em; }
    .card-metric-value { font-size:1.8rem; font-weight:700; margin-top:.25rem; }
    .card-metric-value.positive { color:#4ade80; }
    .card-metric-value.negative { color:#f87171; }
    
    .card-chart { position:absolute; bottom:2rem; right:2rem; width:250px; height:100px; opacity:.3; z-index:1; }
    .card-chart svg { width:100%; height:100%; }
    
    .card-footer { display:flex; justify-content:space-between; align-items:center; z-index:2; }
    .card-branding { font-size:.8rem; color:#666; font-weight:600; letter-spacing:.05em; }
    .card-logo { width:32px; height:32px; background:#7e5bef; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:800; font-size:1rem; }
    
    /* Style variations */
    .style-minimal { background:linear-gradient(135deg, #000 0%, #1a1a1a 100%); }
    .style-vibrant { background:linear-gradient(135deg, #1e1b4b 0%, #7e22ce 100%); }
    .style-clean { background:#fff; color:#000; }
    .style-clean .card-week { color:#666; }
    .style-clean .card-branding { color:#999; }
    .style-clean .card-metric-label { color:#666; }
    
    .info-box { background:var(--bg-gray-900); border:1px solid var(--border-gray-800); padding:1rem 1.25rem; border-radius:.75rem; margin-top:2rem; font-size:.85rem; color:var(--text-gray-400); line-height:1.6; }
    .info-box strong { color:var(--text-white); }
    .info-box ol { margin:.5rem 0 0 1.1rem; padding:0; }
    .info-box ol li { margin:.25rem 0; padding-left:.25rem; }
    /* Password gate styles extracted from inline */
    #password-gate-overlay { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,.9); z-index:9999; }
    .password-gate-form { background:var(--gate-bg,#111); padding:2rem; border:1px solid var(--gate-border,#333); border-radius:.75rem; max-width:320px; width:100%; font-family:system-ui; }
    .password-gate-form h2 { margin:0 0 1rem; font-size:1.2rem; color:#fff; }
    .password-gate-form p { font-size:.75rem; color:#999; line-height:1.3; margin:0 0 1rem; }
    .password-gate-input { width:100%; padding:.6rem .8rem; background:var(--gate-input-bg,#1a1a1a); border:1px solid var(--gate-input-border,#333); border-radius:.5rem; color:var(--gate-input-fg,#fff); margin-bottom:1rem; }
    .password-gate-submit { width:100%; background:var(--btn-primary-bg,#7e5bef); border:none; padding:.6rem 1rem; border-radius:.5rem; font-weight:600; cursor:pointer; color:var(--btn-primary-fg,#fff); }
    #password-gate-error { color:#f87171; font-size:.7rem; margin-top:.75rem; display:none; }
    /* Status message styles */
    .loading-msg { display:none; color:#7e5bef; font-size:.85rem; }
    .error-msg { display:none; color:#f87171; font-size:.85rem; }
    
    @media (max-width:768px) {
      .cards-grid { grid-template-columns:1fr; }
      .twitter-card, .linkedin-card { transform:scale(0.8); transform-origin:top left; }
    }
  </style>
</head>
<body class="bg-black text-white" data-theme="default">
  <a href="#main-content" class="skip-link">Skip to main content</a>
  
  <div id="password-gate-overlay">
    <form id="password-gate-form" class="password-gate-form">
      <h2>Protected Page</h2>
      <p>Enter password to view content.</p>
      <input type="password" id="password-gate-input" class="password-gate-input" placeholder="Password" />
      <button type="submit" class="password-gate-submit">Unlock</button>
      <div id="password-gate-error"></div>
    </form>
  </div>
  <div data-template="header" data-root-path="../"></div>
  
  <main id="main-content" class="container mx-auto px-4 py-10 max-w-7xl" role="main">
    <section class="pixabay-hero mb-10">
      <div class="space-y-6">
        <span class="pixabay-pill">Creative Tooling</span>
        <h1 class="pixabay-title font-bold leading-tight">ðŸ“± Social Media Card Generator</h1>
        <p class="pixabay-hero-copy text-gray-400">
          Generate professional shareable cards for Twitter and LinkedIn with auto-populated portfolio metrics.
        </p>
      </div>
    </section>
    
    <!-- Control Panel -->
    <div class="control-panel">
      <div class="control-row">
        <label for="weekSelect">Select Week:</label>
        <select id="weekSelect">
          <option value="">-- Choose Week --</option>
        </select>
        <button id="generateBtn" type="button" disabled aria-disabled="true" class="action-btn action-btn--primary">Generate Cards</button>
      </div>
      <div id="loadingMsg" role="status" aria-live="polite" class="loading-msg">Loading data...</div>
      <div id="errorMsg" role="alert" aria-live="assertive" class="error-msg"></div>
      <div id="generationStatus" class="visually-hidden" aria-live="polite"></div>
    </div>
    
    <!-- Platform Tabs -->
    <div class="platform-tabs" role="tablist" aria-label="Card platform selection">
      <div class="platform-tab active" role="tab" aria-selected="true" tabindex="0" data-platform="twitter">Twitter (1200Ã—675)</div>
      <div class="platform-tab" role="tab" aria-selected="false" tabindex="-1" data-platform="linkedin">LinkedIn (1200Ã—627)</div>
    </div>
    
    <!-- Cards Grid -->
    <div id="cardsContainer" class="cards-grid" role="region" aria-label="Generated social media cards"></div>
    
    <!-- Info Box -->
    <div class="info-box">
      <strong>How to use:</strong>
      <ol>
        <li>Select a week from the dropdown</li>
        <li>Click "Generate Cards" to create preview cards</li>
        <li>Switch between Twitter and LinkedIn tabs</li>
        <li>Download individual cards as PNG</li>
        <li>Copy card HTML to integrate elsewhere</li>
      </ol>
      <br>
      <strong>Card Styles:</strong> Each platform provides 3 variations (Minimal, Vibrant, Clean) tuned for engagement.
    </div>
  </main>
  <div data-template="footer" data-root-path="../"></div>

<script nonce="qi123">
(function(){
  let weekData = null;
  let availableWeeks = [];
  
  // Available card styles
  const cardStyles = {
    twitter: [
      { id: 'minimal', name: 'Minimal Dark', class: 'style-minimal' },
      { id: 'vibrant', name: 'Vibrant Purple', class: 'style-vibrant' },
      { id: 'clean', name: 'Clean Light', class: 'style-clean' }
    ],
    linkedin: [
      { id: 'minimal', name: 'Professional Dark', class: 'style-minimal' },
      { id: 'vibrant', name: 'Bold Purple', class: 'style-vibrant' },
      { id: 'clean', name: 'Corporate Light', class: 'style-clean' }
    ]
  };
  
  let currentPlatform = 'twitter';
  
  // Initialize
  async function init() {
    // Load master data
    let masterData;
    try {
      const res = await fetch('../master data/master.json');
      if (!res.ok) throw new Error('Failed to load master data');
      masterData = await res.json();
      
      // Discover available weeks from portfolio history
      // First entry (index 0) is inception, skip it
      // W1 = index 1, W2 = index 2, etc.
      for (let i = 1; i < masterData.portfolio_history.length; i++) {
        availableWeeks.push(i);
      }
    } catch (e) {
      document.getElementById('errorMsg').textContent = `Error loading master data: ${e.message}`;
      document.getElementById('errorMsg').style.display = 'block';
      return;
    }
    
    const weekSelect = document.getElementById('weekSelect');
    availableWeeks.forEach(w => {
      const opt = document.createElement('option');
      opt.value = w;
      opt.textContent = `Week ${w}`;
      weekSelect.appendChild(opt);
    });
    
    weekSelect.addEventListener('change', async (e) => {
      const week = parseInt(e.target.value);
      const btn = document.getElementById('generateBtn');
      if (!week) {
        btn.disabled = true;
        btn.setAttribute('aria-disabled', 'true');
        return;
      }
      
      document.getElementById('loadingMsg').style.display = 'block';
      document.getElementById('errorMsg').style.display = 'none';
      
      try {
        // Extract week-specific data from master
        // Week number maps directly to array index (W1 = index 1, W2 = index 2, etc.)
        const weekIndex = week;
        const portfolioEntry = masterData.portfolio_history[weekIndex];
        const date = portfolioEntry.date;
        
        // Build week data structure
        weekData = {
          weekNumber: week,
          portfolio_history: masterData.portfolio_history.slice(0, weekIndex + 1),
          benchmarks: {
            sp500: masterData.benchmarks.sp500
          }
        };
        
        btn.disabled = false;
        btn.setAttribute('aria-disabled', 'false');
        document.getElementById('loadingMsg').style.display = 'none';
      } catch (err) {
        document.getElementById('errorMsg').textContent = `Error loading Week ${week} data: ${err.message}`;
        document.getElementById('errorMsg').style.display = 'block';
        document.getElementById('loadingMsg').style.display = 'none';
        btn.disabled = true;
        btn.setAttribute('aria-disabled', 'true');
      }
    });
    
    document.getElementById('generateBtn').addEventListener('click', generateCards);
    
    // Accessible platform tabs with keyboard support
    document.querySelectorAll('.platform-tab').forEach(tab => {
      tab.addEventListener('click', () => switchPlatform(tab));
      tab.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); switchPlatform(tab); }
        if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
          const tabs = Array.from(document.querySelectorAll('.platform-tab'));
          const idx = tabs.indexOf(tab);
          const next = e.key === 'ArrowRight' ? (idx + 1) % tabs.length : (idx - 1 + tabs.length) % tabs.length;
          tabs[next].focus();
        }
      });
    });
  }
  function switchPlatform(tab){
    document.querySelectorAll('.platform-tab').forEach(t => {
      t.classList.remove('active');
      t.setAttribute('aria-selected','false');
      t.setAttribute('tabindex','-1');
    });
    tab.classList.add('active');
    tab.setAttribute('aria-selected','true');
    tab.setAttribute('tabindex','0');
    currentPlatform = tab.dataset.platform;
    // Only regenerate if cards were already generated (container has content)
    if (weekData && document.getElementById('cardsContainer').children.length > 0) {
      generateCards();
    }
  }
  
  function buildCardElement(style, idx, metrics) {
    const { totalPct, weeklyPct, alpha, sparkData } = metrics;
    const wrapper = document.createElement('div');
    wrapper.className = 'card-wrapper';
    const header = document.createElement('div');
    header.className = 'card-header';
    const title = document.createElement('div');
    const titleId = `card-title-${currentPlatform}-${idx}`;
    title.id = titleId;
    title.className = 'card-title';
    title.textContent = `Option ${idx + 1}: ${style.name}`;
    const actions = document.createElement('div');
    actions.className = 'card-actions';
    const downloadBtn = document.createElement('button');
    downloadBtn.type = 'button';
    downloadBtn.className = 'action-btn';
    downloadBtn.setAttribute('aria-label', `Download card option ${idx + 1} as PNG`);
    downloadBtn.textContent = 'Download PNG';
    downloadBtn.addEventListener('click', () => {
      window.downloadCard(`card-${currentPlatform}-${idx}`, `GenAi-Portfolio-Week${weekData.weekNumber}-${currentPlatform}-${style.id}.png`);
    });
    const copyBtn = document.createElement('button');
    copyBtn.type = 'button';
    copyBtn.className = 'action-btn';
    copyBtn.setAttribute('aria-label', `Copy HTML markup for card option ${idx + 1}`);
    copyBtn.textContent = 'Copy HTML';
    copyBtn.addEventListener('click', () => {
      window.copyCardHTML(`card-${currentPlatform}-${idx}`);
    });
    actions.appendChild(downloadBtn);
    actions.appendChild(copyBtn);
    header.appendChild(title);
    header.appendChild(actions);
    wrapper.appendChild(header);
    wrapper.setAttribute('role','group');
    wrapper.setAttribute('aria-labelledby', titleId);
    const canvasWrapper = document.createElement('div');
    canvasWrapper.className = 'card-canvas-wrapper';
    const card = document.createElement('div');
    card.id = `card-${currentPlatform}-${idx}`;
    card.className = currentPlatform === 'twitter' ? 'twitter-card' : 'linkedin-card';
    card.classList.add(style.class);
    const headline = totalPct >= 0 ? `Portfolio Up ${totalPct.toFixed(2)}% Since Inception` : `Portfolio Performance: ${totalPct.toFixed(2)}%`;
    const headerText = document.createElement('div');
    headerText.className = 'card-header-text';
    const weekEl = document.createElement('div');
    weekEl.className = 'card-week';
    weekEl.textContent = `Week ${weekData.weekNumber} Update`;
    const headlineEl = document.createElement('div');
    headlineEl.className = 'card-headline';
    headlineEl.textContent = headline;
    const metricsWrap = document.createElement('div');
    metricsWrap.className = 'card-metrics';
    function addMetric(label, value, isPositive){
      const m = document.createElement('div');
      m.className = 'card-metric';
      const ml = document.createElement('div'); ml.className = 'card-metric-label'; ml.textContent = label;
      const mv = document.createElement('div'); mv.className = 'card-metric-value ' + (isPositive ? 'positive':'negative'); mv.textContent = `${value >=0?'+':''}${value.toFixed(2)}%`;
      m.appendChild(ml); m.appendChild(mv); metricsWrap.appendChild(m);
    }
    addMetric('Weekly', weeklyPct, weeklyPct>=0);
    addMetric('Alpha vs SPX', alpha, alpha>=0);
    headerText.appendChild(weekEl);
    headerText.appendChild(headlineEl);
    headerText.appendChild(metricsWrap);
    const chartWrap = document.createElement('div');
    chartWrap.className = 'card-chart';
    const svg = document.createElementNS('http://www.w3.org/2000/svg','svg');
    svg.setAttribute('viewBox','0 0 250 100');
    svg.innerHTML = generateSparklinePath(sparkData);
    chartWrap.appendChild(svg);
    const footer = document.createElement('div');
    footer.className = 'card-footer';
    const branding = document.createElement('div'); branding.className='card-branding'; branding.textContent='quantuminvestor.net';
    const logo = document.createElement('div'); logo.className='card-logo'; logo.textContent='Q';
    footer.appendChild(branding); footer.appendChild(logo);
    card.appendChild(headerText);
    card.appendChild(chartWrap);
    card.appendChild(footer);
    canvasWrapper.appendChild(card);
    wrapper.appendChild(canvasWrapper);
    return wrapper;
  }

  function generateCards() {
    if (!weekData) return;
    const container = document.getElementById('cardsContainer');
    container.innerHTML='';
    const styles = cardStyles[currentPlatform];
    const portfolio = weekData.portfolio_history;
    const latest = portfolio[portfolio.length - 1];
    const spx = weekData.benchmarks.sp500.history[weekData.benchmarks.sp500.history.length - 1];
    const weeklyPct = latest.weekly_pct !== null ? latest.weekly_pct : 0;
    const totalPct = latest.total_pct;
    const alpha = totalPct - spx.total_pct;
    const sparkData = portfolio.map(p => p.total_pct);
    const metrics = { totalPct, weeklyPct, alpha, sparkData };
    styles.forEach((style, idx) => {
      container.appendChild(buildCardElement(style, idx, metrics));
    });
    const statusEl = document.getElementById('generationStatus');
    if (statusEl) statusEl.textContent = `${styles.length} card variation${styles.length>1?'s':''} generated for ${currentPlatform} platform.`;
  }
  
  function generateSparklinePath(data) {
    if (!data.length) return '';
    const min = Math.min(...data);
    const max = Math.max(...data);
    const range = max - min || 1;
    const path = data.map((val, i, arr) => {
      const x = (i / (arr.length - 1)) * 250;
      const y = 100 - ((val - min) / range) * 80 - 10; // padding
      return (i === 0 ? 'M' : 'L') + x.toFixed(2) + ',' + y.toFixed(2);
    }).join(' ');
    return `<path d="${path}" fill="none" stroke="#7e5bef" stroke-width="3" stroke-linejoin="round" stroke-linecap="round"/>`;
  }
  
  init();
})();

// Global functions for buttons (must be outside IIFE for event listener access)
window.downloadCard = async function(cardId, filename) {
  const card = document.getElementById(cardId);
  if (!card) {
    console.error('Card element not found:', cardId);
    return;
  }
  
  // Check if html2canvas is loaded
  if (typeof html2canvas === 'undefined') {
    alert('html2canvas library is still loading. Please wait a moment and try again.');
    return;
  }
  
  try {
    // Show status
    const statusEl = document.getElementById('generationStatus');
    if (statusEl) statusEl.textContent = 'Generating PNG...';
    
    // Get the actual dimensions from the card
    const isTwitter = card.classList.contains('twitter-card');
    const scale = isTwitter ? 2 : 2; // 2x for high quality
    
    // Capture the card element as canvas
    const canvas = await html2canvas(card, {
      scale: scale,
      backgroundColor: null,
      logging: false,
      useCORS: true,
      allowTaint: true
    });
    
    // Convert canvas to blob
    canvas.toBlob((blob) => {
      if (!blob) {
        alert('Failed to generate image');
        return;
      }
      
      // Download the blob
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      URL.revokeObjectURL(url);
      document.body.removeChild(a);
      
      // Update status
      if (statusEl) statusEl.textContent = 'Download complete!';
    }, 'image/png');
    
  } catch (error) {
    console.error('Download error:', error);
    alert(`Failed to download card: ${error.message}`);
  }
};

window.copyCardHTML = function(cardId) {
  const card = document.getElementById(cardId);
  if (!card) return;
  
  const html = card.outerHTML;
  navigator.clipboard.writeText(html).then(() => {
    const statusEl = document.getElementById('generationStatus');
    if (statusEl) statusEl.textContent = 'Card HTML copied to clipboard!';
    setTimeout(() => {
      if (statusEl) statusEl.textContent = '';
    }, 2000);
  }).catch(err => {
    console.error('Failed to copy:', err);
    alert('Failed to copy HTML. Check console for details.');
  });
};
</script>



<script src="../js/password-gate.js" data-password-hash="18ae8ef593e3ad19525954a455f81cc50b0b5e6462dc95468eb4d43f9d8ea17d" defer nonce="qi123"></script>
</body>
</html>
